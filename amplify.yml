version: 1
frontend:
  phases:
    preBuild:
      commands:
        - cd client
        - npm ci
    build:
      commands:
        - npm run build
  artifacts:
    baseDirectory: client/dist
    files:
      - '**/*'
  cache:
    paths:
      - client/node_modules/**/*

backend:
  phases:
    build:
      commands:
        - echo "JAVA_HOME is set to $JAVA_HOME"
        - cd server
        - cd cse416
        - export JAVA_HOME=$(readlink -f /usr/bin/java | sed "s:bin/java::") 

        - ./mvnw clean install
  start:
    commands:
      - ./mvnw spring-boot:run
  artifacts:
    baseDirectory: server/target
    files:
      - '**/*'
  cache:
    paths:
      - server/.m2/**/*

cache:
  paths:
    - node_modules/**/*
