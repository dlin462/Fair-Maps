version: 1
frontend:
  phases:
    preBuild:
      commands:
        - cd client
        - npm ci
    build:
      commands:
        - npm run build
  artifacts:
    baseDirectory: client/dist
    files:
      - '**/*'
  cache:
    paths:
      - client/node_modules/**/*

backend:
  phases:
    build:
      commands:
        - cd server
        - cd cse416
        - ls /usr/lib/jvm  # List available JDK versions
        - export JAVA_HOME=$(readlink -f /usr/bin/java | sed "s:bin/java::")  # Adjust to find the correct Java home dynamically
        - echo $JAVA_HOME  # Verify JAVA_HOME is set correctly
        - ./mvnw clean install
  start:
    commands:
      - ./mvnw spring-boot:run
  artifacts:
    baseDirectory: server/target
    files:
      - '**/*'
  cache:
    paths:
      - server/.m2/**/*

cache:
  paths:
    - node_modules/**/*
